<mah:MetroWindow 
	x:Class="Player.MainWindow" x:Name="window" 
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:mah="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
	xmlns:player="clr-namespace:Player.Controls;assembly=ControlLibrary"
	xmlns:system="clr-namespace:System;assembly=mscorlib" Background="{DynamicResource AccentColorBrush}"
	Title="Elephant Player" ShowIconOnTitleBar="False" AllowDrop="True"
	Loaded="Window_Loaded" Closing="Window_Closing" Drop="Window_Drop" KeyUp="Window_KeyUp">
	<mah:MetroWindow.LeftWindowCommands>
		<mah:WindowCommands>
			<StackPanel Orientation="Horizontal">
				<Menu x:Name="Menu" Background="Transparent">
					<MenuItem Background="Transparent">
						<MenuItem.Header>
							<player:Icon Type="ButtonMenu" Foreground="#FEEE"/>
						</MenuItem.Header>
						<MenuItem Header="Run GC"/>
						<MenuItem Header="About"/>
					</MenuItem>
					<MenuItem Background="Transparent">
						<MenuItem.Header>
							<player:Icon Type="Library" Foreground="#FEEE"/>
						</MenuItem.Header>
						<MenuItem Header="Import Library" Click="Menu_LibraryImportClick"/>
						<MenuItem Header="Export Library" Click="Menu_LibraryExportClick"/>
						<MenuItem Header="Heavy Load" Click="Menu_HeavyLoadClick"/>
						<MenuItem Header="Revalidate" Click="Menu_RevalidateClick"/>
					</MenuItem>
				</Menu>
			</StackPanel>
		</mah:WindowCommands>
	</mah:MetroWindow.LeftWindowCommands>
	<mah:MetroWindow.RightWindowCommands>
		<mah:WindowCommands>
			<Menu Background="{DynamicResource AccentColorBrush}">
				<MenuItem Background="Transparent">
					<MenuItem.Header>
						<StackPanel Orientation="Horizontal">
							<player:Icon Type="Settings" Foreground="#FEEE"/>
						</StackPanel>
					</MenuItem.Header>
					<MenuItem>
						<MenuItem.Header>
							<CheckBox x:Name="OrinateCheck" Content="Auto Orinate Vision"/>
						</MenuItem.Header>
					</MenuItem>
					<MenuItem>
						<MenuItem.Header>
							<CheckBox x:Name="LiveLibraryCheck" Content="Live Library"/>
						</MenuItem.Header>
					</MenuItem>
					<MenuItem>
						<MenuItem.Header>
							<CheckBox x:Name="ExplicitCheck" Content="Explicit Content"/>
						</MenuItem.Header>
					</MenuItem>
					<MenuItem>
						<MenuItem.Header>
							<CheckBox x:Name="PlayOnPosCheck" Content="Resume On Position Change"/>
						</MenuItem.Header>
					</MenuItem>
					<MenuItem>
						<MenuItem.Header>
							<CheckBox x:Name="RevalidOnExitCheck" Content="Always Revalidate On Exit"/>
						</MenuItem.Header>
					</MenuItem>
					<MenuItem>
						<MenuItem.Header>
							<CheckBox x:Name="RememberMinimalCheck" Content="Remember Minimal State"/>
						</MenuItem.Header>
					</MenuItem>
					<MenuItem Header="Vision Timeout">
						<ComboBox x:Name="TimeoutCombo" Width="100">
							<ComboBoxItem Content="0.5 s"/>
							<ComboBoxItem Content="1 s"/>
							<ComboBoxItem Content="2 s"/>
							<ComboBoxItem Content="3 s"/>
							<ComboBoxItem Content="4 s"/>
							<ComboBoxItem Content="5 s"/>
							<ComboBoxItem Content="10 s"/>
							<ComboBoxItem Content="60 s"/>
						</ComboBox>
					</MenuItem>
					<MenuItem Header="Play Mode" x:Name="PlayModeSubMenu">
						<MenuItem IsCheckable="True" Header="Repeat All" Tag="0" Click="Menu_PlayModeClick"/>
						<MenuItem IsCheckable="True" Header="Repeat One" Tag="1" Click="Menu_PlayModeClick"/>
						<MenuItem IsCheckable="True" Header="Shuffle" Tag="2" Click="Menu_PlayModeClick"/>
					</MenuItem>
				</MenuItem>
			</Menu>
		</mah:WindowCommands>
	</mah:MetroWindow.RightWindowCommands>
	<Grid x:Name="ContentGrid">
		<DataGrid x:Name="DataGrid" Margin="0,0,0,80" MouseDoubleClick="List_DoubleClick" Background="Transparent" AutoGenerateColumns="False">
			<DataGrid.ContextMenu>
				<ContextMenu>
					<MenuItem Header="Detergent Meta" Click="Menu_TagDetergent" />
					<MenuItem Header="Move to..." >
						<MenuItem Header="{DynamicResource LastPath}" Click="Menu_MoveClick"/>
						<MenuItem Header="Browse..." Click="Menu_MoveClick"/>
					</MenuItem>
					<MenuItem Header="Copy to..." >
						<MenuItem Header="{DynamicResource LastPath}" Click="Menu_CopyClick"/>
						<MenuItem Header="Browse..." Click="Menu_CopyClick"/>
					</MenuItem>
					<MenuItem Header="Remove" Click="Menu_RemoveClick"/>
					<MenuItem Header="Delete" Click="Menu_DeleteClick" />
					<MenuItem Header="Open Location" Click="Menu_LocationClick"/>
					<MenuItem Header="Properties" Click="Menu_PropertiesClick"/>
				</ContextMenu>
			</DataGrid.ContextMenu>
			<DataGrid.Columns>
				<DataGridCheckBoxColumn Visibility="{DynamicResource SelectiveBoxesVisibility}" Binding="{Binding Mode=TwoWay, Path=IsSelected}"/>
				<DataGridTextColumn IsReadOnly="True" FontSize="15" Width="300" Header="Title" Binding="{Binding Title}"/>
				<DataGridTextColumn IsReadOnly="True" Width="120" Header="Artist" Binding="{Binding Artist}"/>
				<DataGridTextColumn IsReadOnly="True" Width="120" Header="Album" Binding="{Binding Album}"/>
				<DataGridTextColumn IsReadOnly="True" Width="60" Header="Plays" Binding="{Binding PlayCount}"/>
				<DataGridTextColumn IsReadOnly="True" Header="Date Added" Binding="{Binding AdditionDate}"/>
			</DataGrid.Columns>
			<DataGrid.RowStyle>
				<Style TargetType="DataGridRow">
					<Setter Property="Template" >
						<Setter.Value>
							<ControlTemplate TargetType="{x:Type DataGridRow}">
								<Border x:Name="DGR_Border"
										Background="Transparent"
										Margin="1">
									<SelectiveScrollingGrid>
										<SelectiveScrollingGrid.ColumnDefinitions>
											<ColumnDefinition Width="Auto" />
											<ColumnDefinition Width="*" />
										</SelectiveScrollingGrid.ColumnDefinitions>
										<SelectiveScrollingGrid.RowDefinitions>
											<RowDefinition Height="*" />
											<RowDefinition Height="Auto" />
										</SelectiveScrollingGrid.RowDefinitions>
										<DataGridCellsPresenter Grid.Column="1"
                                                ItemsPanel="{TemplateBinding ItemsPanel}"
                                                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
										<DataGridDetailsPresenter Grid.Column="1"
                                                  Grid.Row="1"
                                                  SelectiveScrollingGrid.SelectiveScrollingOrientation="{Binding AreRowDetailsFrozen, ConverterParameter={x:Static SelectiveScrollingOrientation.Vertical}, Converter={x:Static DataGrid.RowDetailsScrollingConverter}, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}"
                                                  Visibility="{TemplateBinding DetailsVisibility}" />
										<DataGridRowHeader Grid.RowSpan="2"
                                           SelectiveScrollingGrid.SelectiveScrollingOrientation="Vertical"
                                           Visibility="{Binding HeadersVisibility, ConverterParameter={x:Static DataGridHeadersVisibility.Row}, Converter={x:Static DataGrid.HeadersVisibilityConverter}, RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}" />
									</SelectiveScrollingGrid>
								</Border>
								<ControlTemplate.Triggers>
									<Trigger Property="IsMouseOver" Value="True">
										<Setter TargetName="DGR_Border" Property="Background" Value="LightGray" />
									</Trigger>
									<Trigger Property="IsSelected" Value="True">
										<Setter TargetName="DGR_Border" Property="Background" Value="Gray" />
									</Trigger>
									<DataTrigger Binding="{Binding IsPlaying}" Value="True">
										<Setter TargetName="DGR_Border" Property="Background" Value="#FF0071A6"/>
									</DataTrigger>
								</ControlTemplate.Triggers>
							</ControlTemplate>
						</Setter.Value>
					</Setter>
				</Style>
			</DataGrid.RowStyle>
		</DataGrid>
		<player:MediaPlayer x:Name="Player"/>
		<player:MaterialButton x:Name="MinimalViewButton" Icon="ClosePaneMirrored" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="0,0,12,35" MouseUp="MinimalButton_Clicked"/>
		<Label x:Name="SearchLabel" Content="{Binding Text, ElementName=SearchBox}" HorizontalAlignment="Right" VerticalAlignment="Bottom" Margin="0,0,190,20"/>
		<player:MaterialButton x:Name="SearchButton" HorizontalAlignment="Right" VerticalAlignment="Bottom" Icon="Search" MouseUp="SearchIcon_Click" Margin="0,0,195,35" Width="20" Height="20"/>
		<Popup x:Name="SearchPopup" PlacementTarget="{Binding ElementName=SearchButton}" StaysOpen="False" Placement="Bottom" PopupAnimation="Fade" AllowsTransparency="True">
			<TextBox HorizontalAlignment="Right" VerticalAlignment="Top" Width="140" Height="20" x:Name="SearchBox" TextChanged="SearchBox_TextChanged" />
		</Popup>
	</Grid>
	<Window.Resources>
		<ResourceDictionary>
			<ResourceDictionary.MergedDictionaries>
				<!-- MahApps.Metro resource dictionaries -->
				<ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml" />
				<ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Fonts.xaml" />
				<ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Colors.xaml" />
				<!-- Accent and AppTheme setting -->
				<ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/Steel.xaml" />
				<ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/BaseDark.xaml" />
			</ResourceDictionary.MergedDictionaries>

			<Visibility x:Key="SelectiveBoxesVisibility">Hidden</Visibility>
			<system:Double x:Key="MinimalWidthTemp" />
			<system:Double x:Key="MinimalHeightTemp" />
			<system:String x:Key="LastPath">D:\\</system:String>
			<Style TargetType="DataGridRow">
				<Style.Triggers>
					<DataTrigger Binding="{Binding IsPlaying}" Value="True">
						<Setter Property="Background" Value="#6777" />
						<Setter Property="Foreground" Value="Cyan"/>
					</DataTrigger>
				</Style.Triggers>
			</Style>
		</ResourceDictionary>
	</Window.Resources>
</mah:MetroWindow>
